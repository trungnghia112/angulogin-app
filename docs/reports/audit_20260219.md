# Audit Report â€” 2026-02-19

**Scope:** Quick Security Audit on recent changes (commits `ec735b1..30bed4f`)

**Features Audited:**
- Smart Defaults & Onboarding (Protection Levels)
- Protection Level Badge
- `ungoogled-chromium` launch fix
- Tauri IPC Sync rule

## Summary

- ðŸ”´ Critical Issues: **1** (fixed during audit)
- ðŸŸ¡ Warnings: **1**
- ðŸŸ¢ Suggestions: **2**

---

## ðŸ”´ Critical Issues

### 1. IPC Desync: `protectionLevel` silently dropped by Rust (FIXED)

- **File:** `src-tauri/src/commands.rs` â€” `ProfileMetadata` struct + `save_profile_metadata`
- **Problem:** Frontend sends `protectionLevel` via `invoke('save_profile_metadata', ...)` but Rust struct had no `protection_level` field. Tauri silently ignores unknown params â€” **profiles never persisted their protection level**.
- **Impact:** All protection level selections were lost on restart.
- **Fix:** Added `protection_level`, `browser_engine`, `fingerprint_config`, `fingerprint_os`, `fingerprint_webgl_renderer`, `fingerprint_webgl_vendor` to both the struct and the command params.
- **Commit:** `30bed4f`

---

## ðŸŸ¡ Warnings

### 1. Unused import: `OnboardingDialog` in `home.ts`

- **File:** `src/app/views/pages/home/home.ts:103`
- **Problem:** `OnboardingDialog` is imported but the IDE doesn't detect it in the template (it's used conditionally with `@if`). This is a false positive from the Angular language service, but should be monitored.
- **Risk:** Low â€” cosmetic lint warning, no runtime impact.

---

## ðŸŸ¢ Suggestions

### 1. `home.ts` is 2316 lines â€” consider splitting

- **File:** `src/app/views/pages/home/home.ts`
- **Suggestion:** Extract launch logic, dialog handlers, and protection-level related methods into separate services or child components for maintainability.

### 2. localStorage key `'angulogin-onboarded'` has no versioning

- **File:** `src/app/views/pages/home/home.ts:398`
- **Suggestion:** Consider using a versioned key (e.g., `'angulogin-onboarded-v1'`) so future onboarding flows can re-trigger when significant features are added.

---

## Security Checklist (All Passed)

| Check | Status | Notes |
|-------|--------|-------|
| XSS via template | âœ… | All values use Angular binding, no `innerHTML` |
| Input validation (Onboarding) | âœ… | Only typed `ProtectionLevel` values accepted |
| IPC boundary sync | âœ… | Fixed â€” all frontend metadata fields now in Rust |
| Error handling | âœ… | All async ops wrapped in `try/catch` |
| Secrets exposure | âœ… | No hardcoded keys in new code |
| localStorage abuse | âœ… | Only stores boolean flag, no sensitive data |

---

## Next Steps

The critical IPC desync has been fixed and pushed. No further action required for security.
