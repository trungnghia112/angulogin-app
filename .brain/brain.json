{
    "meta": {
        "schema_version": "1.1.0",
        "awf_version": "4.1.2",
        "updated_at": "2026-02-21T03:40:00+07:00"
    },
    "project": {
        "name": "AnguLogin",
        "type": "desktop-app",
        "status": "production-ready",
        "description": "Multi-browser profile manager with antidetect and automation features (Tauri + Angular)"
    },
    "tech_stack": {
        "frontend": {
            "framework": "Angular 21",
            "ui_library": "PrimeNG",
            "styling": "Tailwind CSS + tailwindcss-primeui",
            "state": "Angular Signals",
            "charts": "PrimeNG Charts (Chart.js wrapper)",
            "drag_drop": "@angular/cdk DragDropModule"
        },
        "backend": {
            "runtime": "Tauri 2.x (Rust)",
            "plugins": [
                "tauri-plugin-fs",
                "tauri-plugin-shell",
                "tauri-plugin-dialog",
                "tauri-plugin-os",
                "tauri-plugin-log"
            ]
        },
        "cloud": {
            "auth": "Firebase Auth (@angular/fire v21)",
            "database": "Firestore (user profiles, RPA templates)",
            "payment": "LemonSqueezy (planned)",
            "oauth": "Google OAuth 2.0 implicit flow via system browser + Rust callback server (port 8923)"
        },
        "database": {
            "local": "JSON metadata per profile (.profile-meta.json)",
            "cloud": "Firestore: users/{uid}, rpa-catalog/index, rpa-templates/{id}"
        }
    },
    "architecture": {
        "profile_storage": {
            "managed_profiles_path": {
                "macOS": "~/Library/Application Support/AnguLogin/Profiles",
                "windows": "%APPDATA%/AnguLogin/Profiles",
                "linux": "~/.config/AnguLogin/Profiles"
            },
            "native_chrome_path": {
                "macOS": "~/Library/Application Support/Google/Chrome",
                "windows": "%LOCALAPPDATA%/Google/Chrome/User Data",
                "linux": "~/.config/google-chrome"
            }
        },
        "profile_detection": {
            "native_profile": "Parent folder has 'Local State' file",
            "managed_profile": "No 'Local State' in parent",
            "valid_profile_check": "Has 'Preferences' file OR named 'Default'/'Profile X'"
        },
        "launch_behavior": {
            "native_profile": "--user-data-dir=<parent> --profile-directory=<folder_name>",
            "managed_profile": "--user-data-dir=<profile_path>"
        }
    },
    "key_files": {
        "rust_commands": "src-tauri/src/commands.rs",
        "tauri_config": "src-tauri/src/lib.rs",
        "settings_service": "src/app/core/services/settings.service.ts",
        "profile_service": "src/app/services/profile.service.ts",
        "home_component": "src/app/views/pages/home/home.ts",
        "storage_dashboard": "src/app/views/pages/storage-dashboard/storage-dashboard.ts",
        "activity_log_service": "src/app/services/activity-log.service.ts",
        "audit_tracker": "docs/FEATURE_AUDIT_TRACKER.md",
        "stealth_extension": "src-tauri/extensions/stealth/content.js",
        "fingerprint_generator": "src-tauri/src/fingerprint/generator.rs",
        "browser_manager": "src/app/services/browser-manager.service.ts",
        "rpa_template_service": "src/app/services/rpa-template.service.ts",
        "rpa_template_model": "src/app/models/rpa-template.model.ts",
        "rpa_marketplace": "src/app/views/pages/automation/rpa-marketplace/rpa-marketplace.ts",
        "firestore_rules": "firestore.rules",
        "seed_script": "scripts/seed-rpa-templates.ts",
        "auth_service": "src/app/services/auth.service.ts",
        "plan_service": "src/app/services/plan.service.ts",
        "user_model": "src/app/core/models/user.model.ts",
        "auth_guard": "src/app/core/guards/auth.guard.ts",
        "login_page": "src/app/views/auth/login/login.ts",
        "register_page": "src/app/views/auth/register/register.ts",
        "forgot_password_page": "src/app/views/auth/forgot-password/forgot-password.ts",
        "terms_page": "src/app/views/auth/terms/terms.ts",
        "privacy_page": "src/app/views/auth/privacy/privacy.ts",
        "oauth_server": "src-tauri/src/oauth.rs",
        "main_nav": "src/app/views/components/main-nav/main-nav.ts"
    },
    "security_audit": {
        "grade": "A-",
        "completed_at": "2026-02-12",
        "modules_audited": 47,
        "issues_found": 56,
        "issues_fixed": 37,
        "key_fixes": [
            "validate_path_safety() in Rust backend — prevents path traversal",
            "sanitizeSettings() — validates imported settings values",
            "csvSafe() — prevents CSV formula injection in exports",
            "backupInProgress/restoreInProgress signals — double-click guards",
            "setScale() bounds check — clamp 12-24px",
            "ActivityLogService load cap — Array.isArray + slice(0, MAX_ENTRIES)",
            "History file 16-byte header check instead of full file read"
        ]
    },
    "features": [
        {
            "name": "Profile Management",
            "status": "implemented",
            "includes": [
                "scan",
                "create",
                "delete",
                "rename",
                "duplicate",
                "backup",
                "restore"
            ]
        },
        {
            "name": "Multi-Browser Support",
            "status": "implemented",
            "browsers": [
                "Chrome",
                "Brave",
                "Edge",
                "Arc"
            ]
        },
        {
            "name": "Profile Metadata",
            "status": "implemented",
            "includes": [
                "emoji",
                "notes",
                "group",
                "tags",
                "launchUrl",
                "isPinned",
                "color",
                "isHidden",
                "sortOrder",
                "isFavorite",
                "customFlags"
            ]
        },
        {
            "name": "Settings Page",
            "status": "implemented",
            "includes": [
                "Appearance (theme, colors, scale, dark mode)",
                "General (default browser, launch behavior, startup options)",
                "Browser Paths (profiles directory selection)",
                "Data Management (export, import, clear, restore from backup)"
            ]
        },
        {
            "name": "Smart Profile Detection",
            "status": "implemented",
            "description": "Auto-detect native vs managed profiles for correct launch"
        },
        {
            "name": "Storage Dashboard",
            "status": "implemented",
            "includes": [
                "storage stats cards",
                "pie chart",
                "bar chart",
                "sortable table",
                "usage statistics"
            ]
        },
        {
            "name": "Usage Statistics",
            "status": "implemented",
            "includes": [
                "launchCount",
                "totalUsageMinutes",
                "lastSessionDuration",
                "session tracking"
            ]
        },
        {
            "name": "Activity Log",
            "status": "implemented",
            "description": "Track profile launches with timestamps, saved in localStorage"
        },
        {
            "name": "Drag & Drop Reordering",
            "status": "implemented",
            "description": "Custom sort mode with drag & drop using Angular CDK"
        },
        {
            "name": "Profile Backup & Restore",
            "status": "implemented",
            "includes": [
                "export as ZIP",
                "restore from ZIP backup",
                "conflict handling"
            ]
        },
        {
            "name": "Favorites (2.4)",
            "status": "implemented",
            "description": "Mark profiles as favorites with heart icon, filter Favorites view"
        },
        {
            "name": "Custom Chrome Flags (3.6)",
            "status": "implemented",
            "description": "User-defined launch flags like --disable-gpu, saved in metadata and passed to browser"
        },
        {
            "name": "Clear Profile Cookies (4.2)",
            "status": "implemented",
            "description": "One-click delete cookies, cache, session storage, local storage, IndexedDB (14+ data types)"
        },
        {
            "name": "Compact Mode (6.7)",
            "status": "implemented",
            "description": "Toggle to display more profiles on screen (8-10 columns vs 4-5), persisted in localStorage"
        },
        {
            "name": "Mobile Responsive UI",
            "status": "implemented",
            "description": "Fully responsive layout for mobile/tablet with collapsible sidebar drawer, hamburger menu, icon-only tabs, and responsive dialogs",
            "includes": [
                "Sidebar drawer with backdrop (hidden on mobile, slides in on tap)",
                "Hamburger menu button (visible only on mobile)",
                "Responsive header toolbar (icon-only buttons on mobile)",
                "Scrollable tabs with icon-only on mobile",
                "Responsive dialog widths min(Xpx, 95vw)"
            ]
        },
        {
            "name": "Proxy Management (4.x)",
            "status": "implemented",
            "includes": [
                "Proxy assignment per profile",
                "Proxy health check",
                "Proxy import/export",
                "Proxy groups by region/provider"
            ]
        },
        {
            "name": "Auto Backup (5.4)",
            "status": "implemented",
            "description": "Scheduled automatic backup with configurable intervals"
        },
        {
            "name": "Usage Heatmap (9.2)",
            "status": "implemented",
            "description": "GitHub-style yearly activity calendar showing daily usage"
        },
        {
            "name": "Profile Health Check (9.3)",
            "status": "implemented",
            "description": "Validate Chrome profile integrity - check for Preferences file, corrupted JSON, required folders"
        },
        {
            "name": "Cleanup Suggestions (9.4)",
            "status": "implemented",
            "description": "Suggest profiles to clean based on size and usage patterns"
        },
        {
            "name": "Folder Management (2.5)",
            "status": "implemented",
            "description": "Group profiles into custom folders. Includes 'Large' (>1GB) and 'Unused' (>30 days) system folders.",
            "includes": [
                "Custom Folders (Create/Edit/Delete)",
                "System Folders (Large, Unused)",
                "Profile Assignment"
            ]
        },
        {
            "name": "Launch with Extensions Toggle (3.4)",
            "status": "implemented",
            "description": "Option to launch browser with --disable-extensions flag"
        },
        {
            "name": "Proxy Rotation (4.2)",
            "status": "implemented",
            "description": "Auto-rotate proxies per_launch, hourly, or daily with proxyGroupId"
        },
        {
            "name": "Zen Mode (6.9)",
            "status": "implemented",
            "description": "Hide MainNav + Sidebar for maximum workspace. Toggle via button or ⌘+\\. Persisted in localStorage. Floating exit button."
        },
        {
            "name": "Mass Tag Assign (12.1)",
            "status": "implemented",
            "description": "Bulk tag assignment: select profiles → Tags button → choose/create tags → Apply. Merges with existing tags."
        },
        {
            "name": "Table UX Columns (11.4+11.5)",
            "status": "implemented",
            "description": "Added Last Changed (relative date) and Running Time (formatted duration) columns to profile table view."
        },
        {
            "name": "Cookie Import/Export (Sprint 1)",
            "status": "implemented",
            "description": "Export/import cookies from Chrome profile SQLite database with keychain decryption",
            "includes": [
                "Rust: AES-128-CBC decryption via Chrome keychain key",
                "Export cookies to JSON (domain, name, value, path, expiry, sameSite)",
                "Import cookies from JSON with upsert (INSERT OR REPLACE)",
                "SameSite round-trip mapping (lax/strict/none/unspecified)",
                "10MB JSON size limit, async Tauri commands",
                "Per-profile loading spinner, file size check before read"
            ]
        },
        {
            "name": "Bulk Create Profiles (Sprint 1)",
            "status": "implemented",
            "description": "Create multiple profiles at once with naming pattern",
            "includes": [
                "Prefix + count + start number inputs",
                "Zero-padded naming (Profile_001, Profile_002...)",
                "Live preview of generated names",
                "Skip existing names, max 500",
                "Toast with created/skipped/errors count"
            ]
        },
        {
            "name": "Profile Templates (Sprint 1)",
            "status": "implemented",
            "description": "Save profile as template, create new profiles from templates",
            "includes": [
                "Templates stored in _templates/ subdirectory",
                "Rust copy_profile_to for cross-directory copies",
                "Save as Template button on each profile row",
                "Create from Template dialog with template list",
                "Delete templates from list"
            ]
        },
        {
            "name": "Antidetect / Protection Levels",
            "status": "implemented",
            "description": "Unified Protection Level UX (Off/Standard/Maximum) with fingerprint spoofing",
            "includes": [
                "Protection Level selector (Off/Standard/Maximum) replacing Privacy Mode + Engine",
                "Standard: Chrome + Stealth Extension (canvas, WebGL, navigator, screen, WebRTC spoofing)",
                "Maximum: Camoufox (antidetect Firefox) integration",
                "Seeded PRNG (Mulberry32) for deterministic fingerprints per profile",
                "Inline config injection (no window.__stealth_config__ exposure)",
                "Auto-migration from legacy antidetectEnabled + browserEngine fields",
                "Fingerprint preview card, Randomize button, OS selector",
                "Ungoogled Chromium auto-download dialog"
            ]
        },
        {
            "name": "Fingerprint Checker Page",
            "status": "implemented",
            "description": "Page at /fingerprint-checker with external checker links, embedded preview, and Launch & Check button"
        },
        {
            "name": "RPA Marketplace",
            "status": "implemented",
            "description": "Template marketplace for RPA automation scripts with Firestore backend",
            "includes": [
                "Firestore 2-tier: catalog index (1 read/session) + detail docs (1 read/click)",
                "15 pre-built templates: TikTok, Facebook, Instagram, LinkedIn, Amazon, etc.",
                "Platform filtering, search, sort (popular/recent/name)",
                "Template detail dialog with steps, variables, tags",
                "Save to process library (localStorage, future: Firestore user doc)",
                "3-layer fallback: Firestore → localStorage → bundled asset",
                "Version-based detail caching (0 reads if version unchanged)",
                "Process page: view/remove saved templates",
                "Task page: view/manage automation tasks (mock data)",
                "Automation sidebar layout with sub-navigation",
                "Seed script for uploading templates to Firestore"
            ]
        },
        {
            "name": "Auth + License System (Phase 1)",
            "status": "implemented",
            "description": "Firebase Authentication with freemium plan gating",
            "includes": [
                "AuthService: login, register, Google sign-in, forgot password, logout",
                "PlanService: feature gating by plan tier (trial/starter/pro/team)",
                "UserProfile model in Firestore (users/{uid})",
                "authGuard (protect app routes) + guestGuard (protect auth routes)",
                "Dynamic user avatar and logout menu in main-nav",
                "Tauri: Google OAuth via system browser + Rust callback (port 8923)",
                "OAuth loading overlay: spinner + waiting message + cancel button",
                "Custom dropdown (replaced p-menu) for sidebar user menu",
                "Google avatar sync (photoURL + displayName) on each login",
                "referrerpolicy=no-referrer for Google profile photos (fix ORB block)"
            ]
        },
        {
            "name": "Premium Auth UI",
            "status": "implemented",
            "description": "Split-screen auth pages: gradient branding panel + clean form panel",
            "includes": [
                "Login: feature highlights + social proof + Google SVG icon",
                "Register: free trial benefits checklist",
                "Forgot Password: security trust message",
                "Real logo-square.svg (not placeholder icons)",
                "Responsive: mobile shows form only, desktop split-screen"
            ]
        },
        {
            "name": "Terms of Use & Privacy Policy",
            "status": "implemented",
            "description": "Legal pages at /terms and /privacy, linked from login and register",
            "includes": [
                "10-section Terms: account, billing, acceptable use, IP, liability, termination",
                "10-section Privacy: data collection, storage, sharing, user rights, GDPR, cookies",
                "Public routes (no auth guard), cross-linked footer"
            ]
        }
    ],
    "api_endpoints": [
        {
            "command": "scan_profiles",
            "description": "Quét folder và trả về danh sách profiles với size"
        },
        {
            "command": "launch_browser",
            "description": "Mở browser với profile, track usage stats, support custom flags"
        },
        {
            "command": "create_profile",
            "description": "Tạo profile mới (folder rỗng)"
        },
        {
            "command": "delete_profile",
            "description": "Xóa folder profile"
        },
        {
            "command": "duplicate_profile",
            "description": "Copy folder profile"
        },
        {
            "command": "rename_profile",
            "description": "Đổi tên folder profile"
        },
        {
            "command": "backup_profile",
            "description": "Nén profile thành file ZIP backup"
        },
        {
            "command": "restore_from_backup",
            "description": "Giải nén ZIP backup thành profile mới"
        },
        {
            "command": "save_profile_metadata",
            "description": "Lưu metadata (emoji, tags, isFavorite, customFlags...) vào .profile-meta.json"
        },
        {
            "command": "get_profile_metadata",
            "description": "Đọc metadata từ .profile-meta.json"
        },
        {
            "command": "clear_profile_cookies",
            "description": "Xóa cookies, cache, IndexedDB, session/local storage (14+ data types)"
        },
        {
            "command": "check_profile_health",
            "description": "Kiểm tra integrity của profile: Preferences file, JSON validity, required folders"
        },
        {
            "command": "export_profile_cookies",
            "description": "Export cookies from Chrome Cookies SQLite DB with keychain decryption (async)"
        },
        {
            "command": "import_profile_cookies",
            "description": "Import cookies JSON into Chrome Cookies SQLite DB with upsert (async, 10MB limit)"
        },
        {
            "command": "copy_profile_to",
            "description": "Copy profile directory to specific destination path (used for templates)"
        }
    ],
    "knowledge_items": {
        "patterns": [
            {
                "name": "Tauri 2.x Environment Detection",
                "code": "window.__TAURI_INTERNALS__ !== undefined",
                "note": "Tauri 1.x uses window.__TAURI__, Tauri 2.x uses window.__TAURI_INTERNALS__"
            },
            {
                "name": "Chrome Profile Directory Structure",
                "note": "User Data Dir contains 'Local State' + profile folders (Default, Profile 1, etc.)"
            },
            {
                "name": "Angular CDK Drag Drop",
                "code": "cdkDropList + cdkDrag directives, moveItemInArray for reorder",
                "note": "Import DragDropModule from @angular/cdk/drag-drop"
            },
            {
                "name": "PrimeNG Charts",
                "code": "<p-chart type=\"pie\" [data]=\"chartData\" [options]=\"options\" />",
                "note": "Wrapper around Chart.js, auto-installed with PrimeNG"
            },
            {
                "name": "Tailwind v4 Source Configuration",
                "code": "@import 'tailwindcss' source(none);\n@source '../src/**/*.html';\n@source '../src/**/*.ts';",
                "note": "Disable auto-detection with source(none), then explicitly define paths to prevent scanning unintended files"
            },
            {
                "name": "localStorage Signal Initialization",
                "code": "signal<boolean>(typeof localStorage !== 'undefined' && localStorage.getItem('key') === 'true')",
                "note": "Safe pattern for SSR-compatible localStorage initialization with signals"
            },
            {
                "name": "Mobile Sidebar Drawer",
                "code": "[class.-translate-x-full]=\"!isOpen()\" [class.lg:translate-x-0]=\"true\" [class.lg:static]=\"true\"",
                "note": "Use translate-x with lg: breakpoint for sidebar that's hidden on mobile but fixed on desktop"
            },
            {
                "name": "Responsive Dialog Width",
                "code": "[style]=\"{ width: 'min(400px, 95vw)' }\"",
                "note": "Use CSS min() function for dialogs that adapt to viewport width on mobile"
            },
            {
                "name": "Responsive Button Visibility",
                "code": "class=\"hidden sm:inline-flex\" for desktop-only, class=\"sm:hidden\" for mobile-only",
                "note": "Pattern for showing different buttons on mobile vs desktop"
            },
            {
                "name": "Seeded PRNG for Fingerprints",
                "code": "SeededRng::new(seed) + Mulberry32 algorithm",
                "note": "Seed from SHA256(profile_path)[..16] → u64. Same profile always gets same fingerprint."
            },
            {
                "name": "Inline Stealth Config Injection",
                "code": "content_js.replace('const CFG = null; /* @@STEALTH_CONFIG@@ */', format!('const CFG = {};', config_json))",
                "note": "Never expose config via window globals. Replace placeholder in content.js before loading extension."
            },
            {
                "name": "Tauri Google OAuth Flow",
                "code": "invoke('oauth_start_google') → shell.open(oauthUrl) → listen('oauth-callback') → signInWithCredential()",
                "note": "System browser handles Google consent, Rust HTTP server (port 8923) captures access_token from hash fragment, emits Tauri event. Angular uses GoogleAuthProvider.credential(null, accessToken)."
            },
            {
                "name": "Custom Dropdown Menu Pattern",
                "code": "<div class='absolute bottom-full left-full'> + signal(false) + (document:click) dismiss",
                "note": "Use when PrimeNG popup components (p-menu) set inline JS positions that can't be overridden. Position with CSS absolute + bottom-full/left-full."
            },
            {
                "name": "Google Avatar ORB Fix",
                "code": "<img [src]=\"photoURL()\" referrerpolicy=\"no-referrer\" />",
                "note": "Google profile photos from lh3.googleusercontent.com are blocked by ORB without referrerpolicy=no-referrer"
            },
            {
                "name": "Protection Levels Data Model",
                "code": "protectionLevel?: 'off' | 'standard' | 'maximum'",
                "note": "Maps to: off→stock chrome, standard→chrome+stealth+flags, maximum→camoufox. Legacy fields (antidetectEnabled, browserEngine) kept for backward compat."
            }
        ],
        "gotchas": [
            {
                "issue": "Using --user-data-dir with profile subfolder creates NEW profile",
                "solution": "Use --user-data-dir=<parent> --profile-directory=<folder> for native profiles"
            },
            {
                "issue": "tauri-plugin-os not working",
                "solution": "Must add to Cargo.toml, register in lib.rs, AND add 'os:default' to capabilities"
            },
            {
                "issue": "PrimeNG v21 renamed InputSwitch to ToggleSwitch",
                "solution": "import { ToggleSwitchModule } from 'primeng/toggleswitch'; use <p-toggleSwitch>"
            },
            {
                "issue": "Rust zip crate may fail on special characters in filenames",
                "solution": "Use options.set_option(zip::write::FileOptions::default().utf_encoded_filenames(true))"
            },
            {
                "issue": "CDK DragDrop in grid layout",
                "solution": "Use cdkDropListDisabled to disable when not in custom sort mode"
            },
            {
                "issue": "Tailwind v4 CSS warning: Expected identifier but found - (invalid class like [-:|])",
                "solution": "Add source(none) to @import 'tailwindcss' and explicitly define @source paths"
            },
            {
                "issue": "NG8107 warning: optional chain operator not needed",
                "solution": "Replace ?.property ?? 'fallback' with @if control flow when signal type doesn't include undefined"
            },
            {
                "issue": "Horizontal tabs overflow on mobile",
                "solution": "Add overflow-x-auto scrollbar-hide whitespace-nowrap to nav container"
            },
            {
                "issue": "Sidebar blocks content on mobile",
                "solution": "Use fixed positioning with -translate-x-full to hide, lg:static lg:translate-x-0 to show on desktop"
            },
            {
                "issue": "App freezes when switching to Browsers tab (29 profiles)",
                "solution": "Root cause: 29 profiles × 3 I/O calls = 87 concurrent Tauri invokes. Fix: (1) Skip re-scan if profiles already loaded, (2) Defer loadProfileSizes with setTimeout"
            },
            {
                "issue": "Duplicate computed signals (proxyGroups in home.ts)",
                "solution": "Use service's existing computed signal directly instead of recreating"
            },
            {
                "issue": "Multiple .filter() calls in computed signals",
                "solution": "Use single-pass counting O(n) instead of O(4n) with multiple filter loops"
            },
            {
                "issue": "async ngOnInit blocks initial render",
                "solution": "Use fire-and-forget pattern: .then() instead of await in ngOnInit"
            },
            {
                "issue": "DMG build fails with 'Resource busy' when previous DMG still mounted",
                "solution": "Run 'hdiutil detach /Volumes/AnguLogin' before npm run tauri build"
            },
            {
                "issue": "Chrome cookie encryption uses domain-specific key from Keychain",
                "solution": "Use 'Chrome Safe Storage' key from macOS Keychain, decrypt with PBKDF2 + AES-128-CBC, strip PKCS7 padding"
            },
            {
                "issue": "SameSite cookie value round-trip fails without 'unspecified' mapping",
                "solution": "Map sameSite: lax→1, strict→2, none→3, unspecified→0 (default). Without 'unspecified' case, import silently corrupts cookies"
            },
            {
                "issue": "Blocking Tauri commands freeze UI during heavy I/O",
                "solution": "Make commands async: pub async fn ... -> Result<T, String>. Tauri runs async commands on thread pool"
            },
            {
                "issue": "Rust OAuth callback server only accepts 2 connections, browser favicon consumes a slot",
                "solution": "Set MAX_REQUESTS=10, handle favicon/unknown requests as 204 No Content, log each request for debugging"
            },
            {
                "issue": "PrimeNG p-menu popup position cannot be overridden with CSS !important",
                "solution": "PrimeNG sets inline top/left via JS after rendering. Replace with custom HTML dropdown using CSS absolute positioning (bottom-full left-full)"
            },
            {
                "issue": "Google avatar blocked by ORB (ERR_BLOCKED_BY_ORB)",
                "solution": "Add referrerpolicy='no-referrer' to img tag. Google CDN blocks cross-origin reads without this."
            },
            {
                "issue": "Tauri event listeners (listen()) leak memory if not cleaned up",
                "solution": "listen() returns Promise<UnlistenFn>. Store the unlisten function and call it on resolve/reject/timeout."
            }
        ],
        "conventions": [
            "All page components MUST have host: { class: 'flex-1 flex flex-col min-h-0 overflow-hidden' }",
            "Use async/await + firstValueFrom for user actions",
            "Commit after every significant change with semantic format",
            "All surfaces need dark: variants for dark mode (bg-surface-0 dark:bg-surface-900)",
            "Use PrimeNG Charts for visualization, not raw Chart.js",
            "New features added to ProfileMetadata must be updated in: TS model, Rust struct, save_profile_metadata, and service method",
            "All user-provided file imports must be sanitized before use (settings, CSV, JSON)",
            "All async operations (backup/restore/delete) should have loading guards to prevent double-click",
            "Rust backend uses validate_path_safety() for all file operations — checks traversal, symlinks, null bytes",
            "CSV export must use csvSafe() to prevent formula injection (=, +, -, @ prefix escaping)",
            "Structural borders (nav, sidebar, dividers) use lighter shades: border-surface-100 dark:border-surface-800",
            "Main-nav, sidebar, and home-container have border-top for visual separation below title bar",
            "App rebranded from 'Chrome Profile Manager' to 'AnguLogin' — all source files, paths, and configs updated",
            "Firestore rules: rpa-catalog + rpa-templates = public read, admin-only write",
            "RPA templates use CatalogEntry (lightweight) for grid, full RpaTemplate (detail) for dialog",
            "Auth pages use split-screen layout: left branding panel + right form panel",
            "Auth pages use host: { class: 'block min-h-screen' } (not flex-1 like app pages)",
            "Google sign-in button uses real SVG logo, not PrimeIcon",
            "Legal pages (/terms, /privacy) are public routes with no guard",
            "Google OAuth client ID stored in environment.ts (firebase.googleClientId), NOT hardcoded in services",
            "Sidebar user menu: custom HTML dropdown (not PrimeNG p-menu) for reliable positioning",
            "Google photos: always use referrerpolicy=no-referrer on img tags",
            "Tauri event listeners: always cleanup with unlisten() on resolve/reject",
            "Firestore rules: always deploy after local changes (firebase deploy --only firestore:rules)"
        ],
        "competitor_analysis": {
            "completed_at": "2026-02-16",
            "competitors": [
                "GoLogin",
                "Multilogin",
                "AdsPower",
                "Incogniton",
                "Kameleo",
                "Octo Browser",
                "BitBrowser",
                "Dolphin Anty"
            ],
            "usp": [
                "Lightweight (~10MB)",
                "Uses real Chrome",
                "Freemium pricing (trial → starter $9 → pro $19 → team $39)"
            ],
            "pricing": {
                "trial": "7 days, 3 profiles, basic fingerprinting",
                "starter_9": "10 profiles, standard fingerprinting, proxy management",
                "pro_19": "100 profiles, max fingerprinting, cloud sync, RPA marketplace",
                "team_39": "300 profiles, all Pro + team collaboration, API access"
            },
            "payment_provider": "LemonSqueezy",
            "gaps": [
                "Automation API",
                "Team collaboration"
            ],
            "report_path": "competitor_analysis.md (in Antigravity brain artifacts)"
        }
    }
}