<aside id="sidebar-container" class="flex flex-col h-screen w-60 bg-sidebar border-r border-border">
    <!-- Feature Header - matches header height -->
    <div id="sidebar-header"
        class="flex items-center justify-between px-4 h-(--spacing-header) shrink-0 border-b border-border">
        <span id="sidebar-header-title" class="text-base font-semibold text-zinc-50">Browsers</span>
        <div id="sidebar-header-actions" class="flex items-center gap-1">
            <button id="sidebar-header-settings-btn"
                class="w-7 h-7 rounded-md flex items-center justify-center text-zinc-500 hover:text-zinc-300 hover:bg-surface-hover transition-colors"
                (click)="openProfilesDirectoryDialog()" title="Profiles Directory">
                <i class="pi pi-cog text-sm"></i>
            </button>
            <button id="sidebar-header-add-btn"
                class="w-7 h-7 rounded-md flex items-center justify-center text-zinc-500 hover:text-zinc-300 hover:bg-surface-hover transition-colors"
                (click)="onAddFolder()" title="Add folder">
                <i class="pi pi-plus text-sm"></i>
            </button>
        </div>
    </div>

    <!-- Folders Header -->
    <div id="sidebar-folders-header" class="flex items-center justify-between px-4 py-2">
        <span id="sidebar-folders-title"
            class="text-xs font-semibold text-zinc-500 uppercase tracking-wide">Folders</span>
        <button
            class="w-6 h-6 rounded flex items-center justify-center text-zinc-600 hover:text-zinc-400 transition-colors"
            (click)="onFolderSettings()" title="Folder settings">
            <i class="pi pi-cog text-xs"></i>
        </button>
    </div>

    <!-- Folders List -->
    <nav id="sidebar-folders-list" class="flex-1 overflow-y-auto px-2">
        @for (folder of folders(); track folder.id; let i = $index) {
        <button [id]="'sidebar-folder-' + i"
            class="w-full flex items-center gap-3 px-3 py-2 rounded-lg mb-0.5 transition-all duration-150" [class]="selectedFolderId() === folder.id 
          ? 'bg-surface-hover text-zinc-50' 
          : 'text-zinc-400 hover:text-zinc-200 hover:bg-surface-hover/50'" (click)="selectFolder(folder.id)">
            <i [class]="'pi ' + getFolderIcon(folder) + ' text-base'" [style.color]="getFolderColor(folder)"></i>
            <span class="text-sm font-medium truncate flex-1 text-left">{{ folder.name }}</span>
            @if (folder.profileCount !== undefined) {
            <span class="text-xs text-zinc-600">{{ folder.profileCount }}</span>
            }
        </button>
        }
    </nav>

    <!-- Bottom Actions -->
    <div id="sidebar-bottom" class="border-t border-border p-3">
        <div id="sidebar-bottom-actions" class="flex items-center justify-between">
            <button id="sidebar-settings-btn"
                class="w-8 h-8 rounded-md flex items-center justify-center text-zinc-500 hover:text-zinc-300 hover:bg-surface-hover transition-colors"
                (click)="onSettings()" title="Settings">
                <i class="pi pi-cog text-sm"></i>
            </button>
            <button id="sidebar-trash-btn"
                class="w-8 h-8 rounded-md flex items-center justify-center text-zinc-500 hover:text-zinc-300 hover:bg-surface-hover transition-colors"
                title="Trash">
                <i class="pi pi-trash text-sm"></i>
            </button>
            <button id="sidebar-export-btn"
                class="w-8 h-8 rounded-md flex items-center justify-center text-zinc-500 hover:text-zinc-300 hover:bg-surface-hover transition-colors"
                title="Export">
                <i class="pi pi-download text-sm"></i>
            </button>
        </div>

        <!-- Language Selector -->
        <div class="flex items-center justify-center mt-3 pt-3 border-t border-border">
            <button id="sidebar-language-btn"
                class="flex items-center gap-2 text-zinc-500 hover:text-zinc-300 transition-colors text-sm">
                <span class="text-base">ðŸ‡¬ðŸ‡§</span>
                <span>EN</span>
            </button>
        </div>
    </div>
</aside>

<!-- Profiles Directory Dialog -->
<p-dialog id="sidebar-profiles-dir-dialog" header="Profiles Directory" [(visible)]="showProfilesDirectoryDialog"
    [modal]="true" [style]="{ width: '480px' }" [draggable]="false" [resizable]="false">
    <div id="sidebar-profiles-dir-dialog-content" class="py-2 space-y-4">
        <p class="text-sm text-zinc-400">
            Set the directory where your Chrome profiles are stored. This path will be used to scan and manage your
            browser profiles.
        </p>
        <div>
            <label for="sidebar-profiles-dir-input" class="block text-xs font-medium text-zinc-500 mb-2">Directory
                Path</label>
            <div class="flex items-center gap-2">
                <input pInputText id="sidebar-profiles-dir-input" type="text" [ngModel]="profilesDirectoryPath()"
                    (ngModelChange)="profilesDirectoryPath.set($event)"
                    placeholder="/Volumes/ExternalDrive/ChromeProfiles"
                    class="flex-1 bg-bg border border-border rounded-lg px-4 py-3 text-zinc-50 text-sm focus:border-primary outline-none" />
                <button id="sidebar-profiles-dir-browse-btn"
                    class="w-10 h-10 rounded-lg border border-border text-zinc-400 hover:text-zinc-50 hover:border-primary transition-colors flex items-center justify-center"
                    title="Browse folder">
                    <i class="pi pi-folder-open"></i>
                </button>
            </div>
        </div>
        <div class="bg-surface-hover/50 rounded-lg p-3 border border-border">
            <div class="flex items-center gap-2 text-xs text-zinc-500">
                <i class="pi pi-info-circle"></i>
                <span>Example: <code class="text-zinc-400">/Users/john/ChromeProfiles</code></span>
            </div>
        </div>
    </div>
    <ng-template #footer>
        <div id="sidebar-profiles-dir-dialog-footer" class="flex justify-end gap-3 pt-2">
            <button id="sidebar-profiles-dir-cancel-btn" pButton
                class="px-5 py-2.5 bg-surface-hover border border-border rounded-lg text-zinc-50 text-sm cursor-pointer"
                (click)="showProfilesDirectoryDialog.set(false)">Cancel</button>
            <button id="sidebar-profiles-dir-save-btn" pButton
                class="px-5 py-2.5 bg-primary border-none rounded-lg text-bg text-sm font-medium cursor-pointer"
                (click)="saveProfilesDirectory()">Save</button>
        </div>
    </ng-template>
</p-dialog>