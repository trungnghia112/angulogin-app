<div id="pages-container" class="flex h-screen overflow-hidden">
    <!-- Main Navigation (Icon Rail) -->
    <app-main-nav />

    <!-- Sub Sidebar (Conditional) -->
    @if (hasSidebar()) {
    <div id="pages-sidebar-wrapper" class="transition-all duration-300 ease-in-out">
        @switch (sidebarType()) {
        @case ('folders') {
        <app-sidebar [folders]="folders()" [selectedFolderId]="selectedFolderId()"
            (folderSelected)="onFolderSelected($event)" (addFolderClicked)="onAddFolder()"
            (settingsClicked)="onSettings()" (folderSettingsClicked)="onFolderSettings()"
            (profilesDirectoryChanged)="onProfilesDirectoryChanged($event)" />
        }
        @case ('extensions') {
        <!-- Extensions sidebar placeholder -->
        <aside id="pages-extensions-sidebar" class="flex flex-col h-screen w-60 border-r border-surface">
            <div id="pages-extensions-sidebar-header" class="px-4 py-4 border-b border-surface">
                <span id="pages-extensions-sidebar-title" class="text-base font-semibold text-color">Extensions</span>
            </div>
            <div id="pages-extensions-sidebar-content"
                class="flex-1 flex items-center justify-center text-color text-sm">
                Coming soon...
            </div>
        </aside>
        }
        @case ('settings') {
        <aside id="pages-settings-sidebar" class="flex flex-col h-screen w-60 border-r border-surface-200 bg-surface-0">
            <div class="h-[var(--spacing-header)] flex items-center px-6 border-b border-surface-200 shrink-0">
                <h1 class="text-xl font-bold text-color">Settings</h1>
            </div>
            <div class="flex-1 p-3 flex flex-col gap-1 overflow-y-auto">
                @for (category of settingsCategories; track category.id) {
                <button (click)="coreSettingsService.setActiveCategory(category.id)"
                    class="w-full flex items-center gap-3 px-4 py-3 rounded-lg text-sm font-medium transition-colors text-left"
                    [class]="coreSettingsService.activeCategory() === category.id 
                        ? 'bg-primary/10 text-primary' 
                        : 'text-muted-color hover:bg-surface-100 hover:text-color'">
                    <i [class]="category.icon + ' text-lg'"></i>
                    {{ category.label }}
                </button>
                }
            </div>
        </aside>
        }
        }
    </div>
    }

    <!-- Main Content -->
    <main id="pages-main-content" class="flex-1 flex flex-col overflow-hidden">
        <router-outlet />
    </main>
</div>