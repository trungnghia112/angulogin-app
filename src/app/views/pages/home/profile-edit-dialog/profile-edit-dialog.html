<p-dialog id="home-edit-dialog" header="Edit Profile" [visible]="visible()" (visibleChange)="onVisibleChange($event)"
    [modal]="true" [style]="{ width: 'min(500px, 95vw)' }" [draggable]="false" [resizable]="false">
    <div id="home-edit-dialog-content" class="py-2 space-y-5">
        <!-- Icon -->
        <div id="home-edit-dialog-icon-section">
            <label class="block text-xs font-medium text-color mb-2">Icon</label>
            <div id="home-edit-dialog-icon-options" class="flex flex-wrap gap-2">
                @for (emoji of emojiOptions; track emoji; let i = $index) {
                <button [id]="'home-edit-dialog-emoji-' + i"
                    class="w-10 h-10 rounded-lg border flex items-center justify-center text-xl cursor-pointer transition-all duration-150"
                    [class]="editEmoji() === emoji ? 'bg-primary border-primary text-white' : 'border-surface hover:border-primary'"
                    (click)="selectEmoji(emoji)">
                    {{ emoji }}
                </button>
                }
            </div>
        </div>

        <!-- Group -->
        <div id="home-edit-dialog-group-section">
            <label class="block text-xs font-medium text-color mb-2">Group</label>
            <div id="home-edit-dialog-group-options" class="flex flex-wrap gap-2">
                @for (group of groupOptions; track group; let i = $index) {
                <button [id]="'home-edit-dialog-group-' + i"
                    class="px-3 py-2 rounded-lg border text-sm cursor-pointer transition-all duration-150"
                    [class]="editGroup() === group ? 'bg-primary border-primary text-white' : 'border-surface text-muted-color hover:border-primary'"
                    (click)="selectGroup(group)">
                    {{ group }}
                </button>
                }
            </div>
        </div>

        <!-- Shortcut -->
        <div id="home-edit-dialog-shortcut-section">
            <label class="block text-xs font-medium text-color mb-2">Keyboard Shortcut</label>
            <div id="home-edit-dialog-shortcut-options" class="flex flex-wrap gap-2">
                @for (num of shortcutOptions; track num; let i = $index) {
                <button [id]="'home-edit-dialog-shortcut-' + i"
                    class="w-10 h-10 rounded-lg border flex items-center justify-center text-sm font-mono cursor-pointer transition-all duration-150"
                    [class]="editShortcut() === num ? 'bg-primary border-primary text-white' : 'border-surface text-muted-color hover:border-primary'"
                    (click)="selectShortcut(num)">
                    âŒ˜{{ num }}
                </button>
                }
            </div>
        </div>

        <!-- Browser -->
        <div id="home-edit-dialog-browser-section">
            <label class="block text-xs font-medium text-color mb-2">Default Browser</label>
            <div id="home-edit-dialog-browser-options" class="flex flex-wrap gap-2">
                @for (browser of availableBrowsers(); track browser; let i = $index) {
                <button [id]="'home-edit-dialog-browser-' + i"
                    class="px-3 py-2 rounded-lg border text-sm cursor-pointer transition-all duration-150 flex items-center gap-2"
                    [class]="editBrowser() === browser ? 'bg-primary border-primary text-white' : 'border-surface text-muted-color hover:border-primary'"
                    (click)="selectBrowser($any(browser))">
                    <i [class]="'pi ' + browserInfo[browser].icon"></i>
                    {{ browserInfo[browser].name }}
                </button>
                }
            </div>
        </div>

        <!-- Color Coding -->
        <div id="home-edit-dialog-color-section">
            <label class="block text-xs font-medium text-color mb-2">Color</label>
            <div id="home-edit-dialog-color-options" class="flex flex-wrap gap-2">
                <!-- Clear color option -->
                <button id="home-edit-dialog-color-none"
                    class="w-8 h-8 rounded-full border-2 flex items-center justify-center cursor-pointer transition-all duration-150"
                    [class]="editColor() === null ? 'border-primary ring-2 ring-primary/30' : 'border-surface hover:border-primary'"
                    (click)="selectColor(null)" title="No color">
                    <i class="pi pi-times text-xs text-muted-color"></i>
                </button>
                @for (color of colorOptions; track color.name; let i = $index) {
                <button [id]="'home-edit-dialog-color-' + i"
                    class="w-8 h-8 rounded-full border-2 cursor-pointer transition-all duration-150"
                    [style.background-color]="color.hex"
                    [class]="editColor() === color.hex ? 'border-primary ring-2 ring-primary/30' : 'border-transparent hover:ring-2 hover:ring-surface'"
                    (click)="selectColor(color.hex)" [title]="color.label">
                </button>
                }
            </div>
        </div>

        <!-- Tags -->
        <div id="home-edit-dialog-tags-section">
            <label class="block text-xs font-medium text-color mb-2">Tags</label>
            <div class="flex flex-wrap gap-2">
                <input id="home-edit-dialog-tags-input" pInputText type="text"
                    placeholder="Type and press Enter to add tags" class="flex-1 min-w-[200px]"
                    (keydown.enter)="addTag($event)" />
            </div>
            @if (editTags().length > 0) {
            <div class="flex flex-wrap gap-2 mt-2">
                @for (tag of editTags(); track tag; let i = $index) {
                <span
                    class="inline-flex items-center gap-1.5 px-2.5 py-1 bg-primary/20 border border-primary/40 rounded-lg text-xs text-primary">
                    {{ tag }}
                    <button (click)="removeTag(i)" class="hover:text-muted-color transition-colors">
                        <i class="pi pi-times text-[10px]"></i>
                    </button>
                </span>
                }
            </div>
            }
        </div>

        <!-- Launch URL -->
        <div id="home-edit-dialog-url-section">
            <label for="home-edit-dialog-url-input" class="block text-xs font-medium text-color mb-2">Launch URL</label>
            <input id="home-edit-dialog-url-input" pInputText type="url" [ngModel]="editLaunchUrl()"
                (ngModelChange)="editLaunchUrl.set($event)" placeholder="https://example.com" class="w-full" />
            <p class="text-xs text-muted-color mt-1">Browser will open this URL when starting the profile</p>
        </div>

        <!-- Pin to Top -->
        <div id="home-edit-dialog-pin-section" class="flex items-center justify-between">
            <div>
                <label class="block text-xs font-medium text-color">Pin to Top</label>
                <p class="text-xs text-muted-color">Keep this profile at the top of the list</p>
            </div>
            <button (click)="editIsPinned.set(!editIsPinned())" class="w-12 h-7 rounded-full transition-colors relative"
                [class]="editIsPinned() ? 'bg-primary' : 'bg-surface-200 border border-surface'">
                <span class="absolute top-1 w-5 h-5 rounded-full shadow transition-all"
                    [class]="editIsPinned() ? 'left-6' : 'left-1'"></span>
            </button>
        </div>

        <!-- Custom Chrome Flags -->
        <div id="home-edit-dialog-flags-section">
            <label for="home-edit-dialog-flags-input" class="block text-xs font-medium text-color mb-2">Custom Chrome
                Flags</label>
            <input id="home-edit-dialog-flags-input" pInputText type="text" [ngModel]="editCustomFlags()"
                (ngModelChange)="editCustomFlags.set($event)" placeholder="--disable-gpu --no-sandbox" class="w-full" />
            <p class="text-xs text-muted-color mt-1">Space-separated flags passed to browser on launch (e.g.,
                --disable-gpu)</p>
        </div>

        <!-- Notes -->
        <div id="home-edit-dialog-notes-section">
            <label for="home-edit-dialog-notes-input" class="block text-xs font-medium text-color mb-2">Notes</label>
            <textarea pTextarea id="home-edit-dialog-notes-input" [ngModel]="editNotes()"
                (ngModelChange)="editNotes.set($event)" placeholder="What is this profile for?" rows="2"
                class="w-full resize-none"></textarea>
        </div>
    </div>
    <ng-template #footer>
        <div id="home-edit-dialog-footer" class="flex justify-end gap-3 pt-2">
            <p-button id="home-edit-dialog-cancel-btn" label="Cancel" severity="secondary" (click)="onCancel()" />
            <p-button id="home-edit-dialog-submit-btn" label="Save" (click)="onSave()" />
        </div>
    </ng-template>
</p-dialog>